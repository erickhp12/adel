{% extends "base.html" %}
{% block title %}ADEL | Visitas {% endblock %}
{% load staticfiles %}

{% block body %}

<meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
 
<div class = "header">
  <p class="header_text">Visitas actuales | {{ total_visitas }} </p>
</div>

<section class="seccion_fondo">
  <!-- *********************************** barra de busqueda *********************************** -->
  <section class="herramientas_menu">      
    <form method=post>
    {% csrf_token %}
      <div class="seccion_busqueda">   
        <span><b>Buscar</b></span>
        
        <input type="text" id="myInput" name="visita" 
        placeholder="nombre o motivo" class="search_busqueda"/>
        
        <input type="text" id="datepicker" name="fecha_inicial" onclick="clear_text()" 
        placeholder="fecha inicial" class="search_busqueda_fecha_inicial"/>

        <input type="text" id="datepickerf" name="fecha_final" onclick="clear_textf()" 
        placeholder="fecha final" class="search_busqueda_fecha_final"/>


      <!-- Seccion botones -->
        <a class="">
          <input type="submit" name="link_add_gasto" 
          class="btn_busqueda" value="Buscar"/>
        </a>
        <a href="/registro.visita">
          <input type="button" name="link_add_gasto" 
          class="btn_agregar_elemento" value=" Agregar una visita"/>
        </a>
      </div>

    </form>
  </section>
<hr>
<!-- tabla de datos -->
  <section class="tbl_visitas">
   <table>
     <thead class="columna">
          <th style="width: 15%;">Paciente</th>
          <th style="width: 25%;">Motivo</th>
          <th style="width: 20%;">Fecha</th>
          <th style="width: 5%;">Informacion</th>
          <th style="width: 6%;">Edicion</th>
          <th style="width: 7%;">Acciones</th>
     </thead>
      {% for visita in visitas %}
     <tbody class="contenido">
          <td style="width: 15%;">{{ visita.paciente }}</td>
          <td style="width: 25%;">{{ visita.motivo }}</td>
          <td style="width: 20%;">{{ visita.fecha_visita }}</td>
          <!-- <td style="width: 6%;">
            <a href="{{ visita.url_ver_visitas }}" class="glyphicon glyphicon-search"> Ver</a>
          </td> -->
          <td>
             <a type="button" class="glyphicon glyphicon-search" data-toggle="modal" data-target="#myModal"> Ver
             </a>
          </td>
          <td style="width: 7%;">
            <a href="{{ visita.url_editar_visitas }}" class="glyphicon glyphicon-pencil"> Editar</a>
          </td>
          <td style="width: 7%;">
            <a href="{{ visita.url_borrar_visitas }}" class="glyphicon glyphicon-trash"> Borrar</a>
          </td>
     </tbody>
     {% endfor %}
    </table>
    <br><br>
  </section>
</section>


<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog">
      <!-- Modal content-->
    {% for paciente in visitas %}
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Paciente {{ paciente.paciente }}</h4>
      </div>
      <div class="modal-body">
        <p>ID {{ paciente.pk }}</p>
        <p>Fecha  {{ paciente.fecha_visita }}</p>
        <p>Motivo  {{ paciente.motivo }}</p>
        <p>Dentista {{ paciente.dentista }}</p>
        <p>Precio {{ paciente.precio }}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
    {% endfor %}
  </div>
</div>


<script>
function clear_text() { 
    document.getElementById('datepicker').placeholder = "";
}
function clear_textf() { 
    document.getElementById('datepickerf').placeholder = "";
}

$(function () {
  $.datepicker.setDefaults($.datepicker.regional["es"]);
  $("#datepicker").datepicker({
    firstDay: 1,
    monthNames: ['Enero', 'Febrero', 'Marzo','Abril', 'Mayo','Junio',
    'Julio','Agosto','Septiempbre','Octubre','Noviembre','Diciembre'],
    dayNamesMin: ['Dom','Lun','Mar','Mier','Jue','Vier','Sab'],
    dateFormat: 'yy-mm-dd',
    timeFormat:  "hh:mm:ss"
    });
  });
</script>

<script>
  $(function () {
  $.datepicker.setDefaults($.datepicker.regional["es"]);
  $("#datepickerf").datepicker({
    firstDay: 1,
    monthNames: ['Enero', 'Febrero', 'Marzo','Abril', 'Mayo','Junio',
    'Julio','Agosto','Septiempbre','Octubre','Noviembre','Diciembre'],
    dayNamesMin: ['Dom','Lun','Mar','Mier','Jue','Vier','Sab'],
    dateFormat: 'yy-mm-dd',
    timeFormat:  "hh:mm:ss"
    });
  });
</script>

{% endblock %}


