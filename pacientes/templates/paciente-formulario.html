{% extends 'base.html' %}
{% block title %}ADEL | pacientes {% endblock %}
{% block body %}

    {% load staticfiles %}
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <script src="{% static '/static/js/generic/calendarios.js'%}"></script>

<!-- ************************************  HELPER ************************************ -->
 <div class="container col-md-8 thumbnail col-md-offset-2 bs-header">
    <div class="col-md-2">
        <a href="/lista.pacientes" class="glyphicon glyphicon-chevron-left bs-header-back">&nbsp;Volver</a>
    </div>
    <div class="col-md-9 bs-header-text helper-text">
        {% if paciente.nombre %}
            <label>{{ paciente.nombre }}</label>
        {% else %}
            <label>Agregar paciente</label>
        {% endif %}
    </div>
    <div class="helper-img col-md-1">
        <img src="{% static 'img/iconos/pacientes40.png' %}"  class="helper-img" alt="ups">
    </div>
</div>

    <!-- ************************************ FORM ************************************ -->
<div class="container col-md-8 thumbnail col-md-offset-2">
    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <br>
            <form method="post">
                {% csrf_token %}
                <fieldset class="fieldset">
                    <legend>
                        <b>Información requerida</b>
                    </legend>

                    <div class="form-group col-md-6">
                        <label>Nombre</label>
                        {% if paciente.nombre %}
                            <input type="text" value="{{ paciente.nombre}}" name="nombre" id="nombre" readonly="readonly"> 
                        {% else %}
                            <input type="text" name="nombre" id="nombre" class="input-personalized"> 
                        {% endif %}
                    </div>
                    <div class="form-group col-md-6">
                        <label>Fecha de nacimiento</label>
                            <input type="text" id="datepickerf" name="fecha_nacimiento" value="2018-01-18" class="input-personalized">
                        </select>
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <div class="form-group col-md-6">
                        <label>Sexo</label>
                        <select id="sexo" name="sexo">
                        {% if paciente.nombre %}
                            <option id="sexo" name="sexo" value={{paciente.sexo}} >{{paciente.sexo}}</option> 
                        {% else %}
                            <option id="sexo" name="sexo" value="------">------</option> 
                        {% endif %}
                            {% for choice in form.sexo.field.choices %}
                                <option id="sexo" name="sexo" value={{choice.1}} >{{ choice.1}}</option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <div class="form-group col-md-6">
                        <label>Tipo de paciente</label>
                        <select id="tipo_paciente" name="tipo_paciente" onchange="reassign_values()">
                        {% if paciente.nombre %}
                            <option id="tipo_paciente" name="tipo_paciente" value={{paciente.tipo_paciente}} >{{paciente.tipo_paciente}}</option> 
                        {% else %}
                            <option id="tipo_paciente" name="tipo_paciente" value="------">------</option> 
                        {% endif %}
                            {% for choice in form.tipo_paciente.field.choices %}
                                <option id="tipo_paciente" name="tipo_paciente" value={{choice.1}} >{{ choice.1}}</option>
                            {% endfor %}
                        </select>
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <div class="form-group col-md-6">
                        <label>Aseguranza</label>
                        <input type="text" name="aseguranza" id="aseguranza" value="{{paciente.aseguranza}}" class="input-personalized">
                    </div>
                    <div class="form-group col-md-6">
                        <label>Teléfono</label>
                        <input type="text" value="{{ paciente.telefono }}" placeholder="(656) 336-46-63"
                        name="telefono" id="telefono" class="input-personalized">
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <div class="form-group col-md-6">
                        <label>Correo electrónico</label>
                        <input type="text" name="correo" id="correo" value="{{ paciente.correo }}" class="input-personalized">
                    </div>
                    <div class="form-group col-md-6">
                        <label>Dirección</label>
                        <input type="text" value="{{ paciente.direccion }}" name="direccion" id="direccion" class="input-personalized">
                    </div>
                </fieldset>

                <fieldset class="fieldset">
                    <div class="form-group col-md-12">
                        <label>Comentarios</label>
                        <textarea class="form-control" id="comentarios" name="comentarios" rows="5" id="comment">{{ paciente.comentarios }}</textarea>
                    </div>
                </fieldset>

                <div class="form-group">
                    <div class="col-md-12">
                            {% if paciente.nombre %}
                                <button type="submit" onclick="set_empty_values()" class="btn btn-success col-md-4">Actualizar información</button>
                            {% else %}
                                <button type="submit" onclick="set_empty_values()" class="btn btn-success col-md-4">Agregar paciente</button>
                            {% endif %}
                        <br>
                        <br>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
    <!-- ************************************ JS ************************************** -->
    <script>
        function set_empty_values() {
            nombre = document.getElementById('nombre');
            fecha_nacimiento = document.getElementById('datepickerf');
            sexo = document.getElementById('sexo');
            tipo_paciente = document.getElementById('tipo_paciente');
            aseguranza = document.getElementById('aseguranza');
            telefono = document.getElementById('telefono');
            correo = document.getElementById('correo');
            direccion = document.getElementById('direccion');
            comentarios = document.getElementById('comentarios');

            console.log('DENTRO DE FUNCION');
            console.log('nombre ' + nombre.value);
            console.log('fecha_nacimiento ' + fecha_nacimiento.value);
            console.log('sexo ' + sexo.value);
            console.log('tipo_paciente' + tipo_paciente.value);
            console.log('aseguranza' + aseguranza.value);
            console.log('telefono ' + telefono.value);
            console.log('correo ' + correo.value);
            console.log('direccion' + direccion.value);


            if (nombre.value == "") {
                alert('el campo nombre es requerido');
                nombre.value = "";
            }
            if (fecha_nacimiento == undefined) {
                alert('el campo fecha de nacimiento es requerido');
                fecha_nacimiento.value = "2018-01-18";
            }
            if (sexo.value == "") {
                sexo.value = "---";
            }
            if (tipo_paciente.value == "") {
                tipo_paciente.value = "---";
            }
            if (aseguranza.value == "") {
                aseguranza.value = "---";
            }
            if (telefono.value == "") {
                telefono.value = "No registrado";
            }
            if (correo.value == "") {
                correo.value = "---";
            }
            if (direccion.value == "") {
                direccion.value = "---";
            }
            if (comentarios.value == "") {
                comentarios.value = "---";
            }
        }

        function reassign_values(){
            var textbox_aseguranza = document.getElementById('aseguranza');
            var tipo_paciente = document.getElementById('tipo_paciente');
            if (tipo_paciente.value == "Aseguranza") {
            textbox_aseguranza.readOnly = false;
            textbox_aseguranza.value = "";
            textbox_aseguranza.placeholder = "Introduce la aseguranza";
            }else{
                textbox_aseguranza.readOnly = true;
                textbox_aseguranza.value = "No aplica";
                textbox_aseguranza.placeholder = "";
            }
        }
    </script> 

{% endblock %} 